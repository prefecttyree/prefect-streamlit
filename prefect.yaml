# generic metadata



# Generic metadata about this project
name: Sales-Analysis
prefect-version: 3.0.0

# build section allows you to manage and build docker images
# build:
# - prefect.deployments.steps.run_shell_script:
#     id: get-commit-hash
#     script: git rev-parse --short HEAD
#     stream_output: false
# - prefect_docker.deployments.steps.build_docker_image:
#     id: build-image
#     requires: prefect-docker>=0.4.0
#     image_name: tytheprefectionist/sales-analysis
#     tag: '{{ get-commit-hash.stdout }}'
#     platform: linux/amd64

# # push section allows you to manage if and how this project is uploaded to remote locations
# push:
# - prefect_docker.deployments.steps.push_docker_image:
#     requires: prefect-docker>=0.4.0
#     image_name: '{{ build-image.image_name }}'
#     tag: '{{ build-image.tag }}'

# pull section allows you to provide instructions for cloning this project in remote locations
# pull:
# - prefect.deployments.steps.set_working_directory:
#     directory: /opt/prefect/flows
# - prefect_docker.deployments.steps.pull_docker_image:
#     id: pull-image
#     image_name: '{{ build-image.image_name }}'
#     tag: '{{ build-image.tag }}'
#     schedule:
#       interval: 3600  # 3600 seconds = 1 hour

# the definitions section allows you to define reusable components for your deployments
definitions:
  tags:
  - gke-pool
  - '{{ get-commit-hash.stdout }}'
  work_pool:
    name: gke-pool
    job_variables:
      image: '{{ build-image.image }}'

# the deployments section allows you to provide configuration for deploying flows
deployments:
- name: main-flow
  tags:
  - gke-pool
  entrypoint: flows/hello.py:mainflow
  work_pool:
    name: gke-pool
    job_variables:
      image: '{{ build-image.image }}'
    work_queue_name:
  version:
  description:
  parameters: {}
  schedules:
  - interval: 60.0
    anchor_date: '2024-07-25T21:45:37.544028+00:00'
    timezone: UTC
    active: true
    max_active_runs:
    catchup: false

- name: get-repo-info
  tags:
  - gke-pool
  entrypoint: flows/get_repo.py:repo_info
  parameters:
    name: Arthur
  work_pool:
    name: gke-pool
    job_variables:
      image: '{{ build-image.image }}'
    work_queue_name:
  version:
  description:
  schedules: []
  pull:
  - prefect.deployments.steps.set_working_directory:
      directory: /opt/prefect/flows
  - prefect_docker.deployments.steps.pull_docker_image:
      id: pull-image
      image_name: tytheprefectionist/prefect-demo
      tag: e82ebbb
      schedule:
        interval: 3600

- name: control-flow-analysis
  description: "Deployment for sales analysis"
  tags:
    - salesv2
    - analysis
  entrypoint: pages/Salesv2.py:control_flow_analysis
  work_pool:
    name: gke-pool
    # job_variables:
    #   image: '{{ build-image.image }}'
    # work_queue_name:
  schedule: []
  parameters:
    - name: openai_api_key
      description: "OpenAI API key for AI-powered analysis"
      type: str
      required: true
      secret: true

